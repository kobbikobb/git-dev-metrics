name: Feature Explorer

on:
  schedule:
    - cron: '0 6 * * *'
  workflow_dispatch:

concurrency:
  group: feature-explorer
  cancel-in-progress: false

jobs:
  explore:
    runs-on: ubuntu-latest
    continue-on-error: true
    permissions:
      contents: read
      issues: write
      id-token: write
    steps:
      - uses: actions/checkout@v4

      - uses: anomalyco/opencode/github@v1
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        with:
          model: google/gemini-2.5-flash
          prompt: |
            You are a Feature Explorer. Your job is to understand the project vision and find feature gaps.

            ## Instructions

            1. **Understand the Vision**: Read README.md, any docs, and explore the codebase to understand:
               - What is this project trying to achieve?
               - What problems does it solve?
               - Who is the target user?

            2. **Discover Current Capabilities**: Explore the codebase to understand what features currently exist:
               - What features are implemented?
               - What CLI commands exist?
               - What are the main modules and their purposes?

            3. **Find Feature Gaps**: Identify features that should exist but don't:
               - Features that solve real user needs
               - Features that similar projects have
               - Features that would make the project more useful

            4. **Check for Existing Issues**: Before creating any issue, search for existing GitHub issues that may already cover the same topic. Use: `gh issue list --search "your keywords"`.

            5. **Create Issues**: For each valid finding, create a GitHub issue with:
               - Clear title describing the feature gap
               - Body explaining: what the feature should do, why it's useful, reference to similar implementations if found
               - Label: `explorer:feature`

            ## Output Format

            Create 1-3 issues maximum (focus on highest value). For each:
            ```
            Title: [Feature Name]: Brief description
            Body:
            ## What
            Describe what this feature should do

            ## Why
            Why this would be valuable

            ## References
            Any similar implementations or references
            ```

            If no valuable feature gaps found, respond with "NO_ISSUES_CREATED" and explain why.
